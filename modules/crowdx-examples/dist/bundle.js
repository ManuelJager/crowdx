(()=>{"use strict";const e=new(function(){function e(){this.observables=new Map}return e.prototype.registerObserver=function(e,t){var n=this.observables.get(e);void 0===n&&(n=[],e.onBecomeObserved()),n.push(t),this.observables.set(e,n)},e.prototype.unregisterObserver=function(e,t){var n=this.observables.get(e);if(void 0===n)throw new Error("Cannot unregister observer for unobserved observable");var o=n.indexOf(t);n.splice(o,1),0===n.length?(e.onBecomeUnobserved(),this.observables.delete(e)):this.observables.set(e,n)},e.prototype.unregisterAllObservers=function(e){if(void 0===this.observables.get(e))throw new Error("Cannot unregister observer for unobserved observable");e.onBecomeUnobserved(),this.observables.delete(e)},e.prototype.notifyObservers=function(e,t,n){var o=this.observables.get(e);void 0!==o&&o.map((function(e){var o,r;(null===(r=(o=e.options).equality)||void 0===r?void 0:r.call(o,t,n))||e.onUpdate(t,n)}))},e}());var t=function(){function t(e,t){this.value=e,this.options=t}return t.prototype.get=function(){return this.value},t.prototype.set=function(t){var n=this.value;this.value=t,e.notifyObservers(this,t,n)},t.prototype.onBecomeObserved=function(){var e;console.log("observable "+(null!==(e=this.options.debugName)&&void 0!==e?e:"")+" onBecomeObserved")},t.prototype.onBecomeUnobserved=function(){var e;console.log("observable "+(null!==(e=this.options.debugName)&&void 0!==e?e:"")+" onBecomeUnobserved")},t}();const n=function(e,n){return void 0===n&&(n={debugName:"default"}),new t(e,n)};var o=function(e,t){return e===t},r=function(e){"function"!=typeof(null==e?void 0:e.equality)&&(e.equality=o)},i=function(e,t,n){this.dep=e,this.options=n,this.onUpdate=t};const s=function(t,n,o){void 0===o&&(o={}),r(o);var s=new i(t,n,o);return e.registerObserver(t,s),[s,function(){return e.unregisterObserver(t,s)}]};var u=function(){function t(e,t,n){this.deps=e,this.handler=t,this.options=n,this.observed=!1,this.promiseQueue=[],this.awaitingValues=[],this.updateValue(!1)}return t.prototype.getDependencyValues=function(){for(var e={},t=0,n=Object.entries(this.deps);t<n.length;t++){var o=n[t],r=o[0],i=o[1];e[r]=i.get()}return e},t.prototype.notifyAwaitingValues=function(){for(var t=0,n=this.awaitingValues;t<n.length;t++){var o=n[t],r=this.value;this.value=o.value,o.notifyObservers&&e.notifyObservers(this,this.value,r)}},t.prototype.updateValue=function(t){var n=this;void 0===t&&(t=!0);var o=this.value,r=this.getDependencyValues(),i=this.handler(r);if(i instanceof Promise){this.promiseQueue.push(i);var s=this.promiseQueue.indexOf(i);i.then(function(n){if(this.promiseQueue[0]!==i)this.awaitingValues.push({value:n,notifyObservers:t});else{var o=this.value;this.value=n,t&&e.notifyObservers(this,this.value,o),this.notifyAwaitingValues()}this.promiseQueue.splice(s,1)}.bind(this)).catch((function(e){"function"==typeof n.options.errorHandler?n.options.errorHandler(e):console.error("Unhandled error",e)}))}else this.value=i,t&&e.notifyObservers(this,this.value,o)},t.prototype.get=function(){if(!this.observed)throw new Error("Cannot get value of unobserved computed");return this.value},t.prototype.onUpdate=function(){return e=this,t=void 0,o=function(){return function(e,t){var n,o,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}(this,(function(e){return this.updateValue(),[2]}))},new((n=void 0)||(n=Promise))((function(r,i){function s(e){try{a(o.next(e))}catch(e){i(e)}}function u(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,u)}a((o=o.apply(e,t||[])).next())}));var e,t,n,o},t.prototype.onBecomeObserved=function(){var t;console.log("computed "+(null!==(t=this.options.debugName)&&void 0!==t?t:"")+" onBecomeObserved"),this.observed=!0;for(var n=0,o=Object.values(this.deps);n<o.length;n++){var r=o[n];e.registerObserver(r,this)}},t.prototype.onBecomeUnobserved=function(){var t;console.log("computed "+(null!==(t=this.options.debugName)&&void 0!==t?t:"")+" onBecomeUnobserved"),this.observed=!1;for(var n=0,o=Object.values(this.deps);n<o.length;n++){var r=o[n];e.unregisterObserver(r,this)}},t}();var a=n(0);s(a,(function(e){document.getElementById("counter").innerText="Counter: "+e})),setInterval((function(){a.set(a.get()+1)}),1e3);var l,v,c,h=n(10),f=(l={weightInKG:h},v=function(e){var t=e.weightInKG;return Math.round(2.20462262*t*100)/100},void 0===c&&(c={}),r(c),new u(l,v,c));s(h,(function(e){document.getElementById("weight-kg").innerText="KG: "+e.toString()})),s(f,(function(e){document.getElementById("weight-lb").innerText="LB: "+e.toString()})),document.getElementById("weight-button").onclick=function(){var e=document.getElementById("weight-input").value;parseFloat(e)&&h.set(parseFloat(e))}})();